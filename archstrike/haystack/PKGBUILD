# Maintainer: ArchStrike <team@archstrike.org>

buildarch=1

pkgname=haystack
pkgver=0.34
pkgrel=1
pkgdesc='A Python framework for Finding C Structures from process memory - heap analysis - Memory structures forensics'
arch=('any')
url='https://github.com/trolldbois/python-haystack'
license=('GPL3')
groups=('archstrike' 'archstrike-forensics')
depends=('python2-pefile' 'python2-levenshtein' 'python2-ptrace' 'python2-argparse' 'python2-networkx')
makedepends=('python2-setuptools')
source=("https://github.com/trolldbois/python-$pkgname/archive/v$pkgver.tar.gz")
sha512sums=('d0fb4b59acfef350a04ebc98dbc039d79acc5a516f21f12bfcb05f68adb3c64b7ed8ee7680c5bf9de21abe719f5099d2e28296b86bd4dee264d71261d35eb269')

prepare() {
  while read -r; do
      sed -i -re 's|#!\s*(/usr)?(/local)?/bin/.*python.*$|#!/usr/bin/env python2|g' "$REPLY"
  done < <(egrep -rl '^\s*#!\s*(/usr)?(/local)?/bin/.*python')
}

package() {
  cd python-$pkgname-$pkgver
  python2 setup.py install --root="$pkgdir" --optimize=1
}
