# Maintainer: ArchStrike <team@archstrike.org>

buildarch=1

pkgname=python2-bson
_pkgname=bson
pkgver=0.5.0
pkgrel=1
pkgdesc="BSON codec for Python"
url="https://github.com/py-bson/bson"
depends=('python2' 'python2-pytz' 'python2-pymongo')
makedepends=('python2-setuptools' 'python2-pip')
license=('Apache')
arch=('any')
source=("https://pypi.python.org/packages/62/03/5315c1bba25c90ba97574c9f0f15dc4bd7a545cae7594f6ee0f0ec46da3d/bson-0.5.0.tar.gz")
sha512sums=('cb3e21be6d8c225df6be34d64c5c0590f06a2c0f74411c525291d175da56e2cd132c558141e63bff566b8bed76431158f40dcbd63b78e9f41d75d49f210cb706')

prepare() {
  grep -iRl 'python' ${_pkgname}-${pkgver} | xargs sed -i 's|python$|python2|g'
}

build() {
  cd ${_pkgname}-${pkgver}
  python2 setup.py build
}

package() {
  cd ${_pkgname}-${pkgver}
  python2 setup.py install --root="${pkgdir}" -O1 --skip-build

  #fix conflict with python2-pymongo
  rm -f ${pkgdir}/usr/lib/python2.7/site-packages/bson/__init__*
}
