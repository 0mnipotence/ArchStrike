# Maintainer: ArchStrike <team@archstrike.org>

buildarch=212

pkgname=netsniff-ng
pkgver=0.6.0
pkgrel=1
groups=('archstrike' 'archstrike-sniffers')
pkgdesc="A high performance Linux network sniffer for packet inspection."
depends=('geoip' 'zlib' 'libnacl' 'libcap' 'liburcu' 'gnuplot' 'libcli' 'libnet' 'libnetfilter_conntrack' 'libpcap' 'libnl')
arch=('i686' 'x86_64' 'armv6h' 'armv7h')
url='http://netsniff-ng.org/'
license=('GPL2')
source=(https://github.com/netsniff-ng/netsniff-ng/archive/v${pkgver}.tar.gz
  netsniff-ng_configureForArch.patch)
sha512sums=('bcce6aa0e7d0ca3ba149bc0d6371deca566135d6d84126a20477d61ce0f06c8eaaa3299c58a17f8ff12b147bfe36016f284e4a2f622c1c417f45095dd3de37f4'
            '621cebe2901829cdb324fe7e58fe7057ac8f455aa1586647df740fd195717778c78baeaab79789564ad61ab9ce92242d320fd39af41b93d879c7d17a46811022')

build() {
  cd "$srcdir/netsniff-ng-${pkgver}"
  ./configure
  patch -p1 -i "$srcdir"/netsniff-ng_configureForArch.patch Makefile
  make PREFIX=/usr
}

package() {
  cd "$srcdir/netsniff-ng-${pkgver}"
  install -dm755 "$pkgdir"/usr/bin
  install -dm755 "$pkgdir"/usr/share/man/man8/
  make DESTDIR="${pkgdir}" install
}
